<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><base href="../../../"><link rel="stylesheet" href="dmdoc.css"><title>/obj/effect/map_effect/portal - Space Station 13</title></head><body><header><a href="index.html">Space Station 13</a> - <a href="index.html#modules">Modules</a> - <a href="index.html#types">Types</a> — <a href="obj/effect/map_effect/portal.html#var">Var Details</a> - <a href="obj/effect/map_effect/portal.html#proc">Proc Details</a></header><main><h1>portal <aside>/<a href="obj.html">obj</a>/<a href="obj/effect/map_effect/portal.html">effect/map_effect/portal</a></aside> <a href="https://github.com/Baystation12/Baystation12/blob/184edfd8b360868f05186630736e3d1846726650/code/game/objects/effects/map/portal.dm#L48"><img src="git.png" width="16" height="16" title="code/game/objects/effects/map/portal.dm 48"></a></h1><ul>
<li><h1 id="portals">Portals</h1></li>
</ul>
<p>Portal map effects allow a mapper to join two distant places together, while looking somewhat seamlessly connected.
This can allow for very strange PoIs that twist and turn in what appear to be physically impossible ways.</p>
<p>Portals do have some specific requirements when mapping them in;
- There must by one, and only one <code>/obj/effect/map_effect/portal/master</code> for each side of a portal.
- Both sides need to have matching <code>portal_id</code>s in order to link to each other.
- Each side must face opposite directions, e.g. if side A faces SOUTH, side B must face NORTH.
- Clarification on the above - you will be moved in the direction that the portal faces.
If Side A faces south, you will be moved south. Dirs are 1/2/4/8, 1: NORTH, 2: SOUTH, 4: EAST, 8: WEST.
To further explain: If your cave entrance is on the NORTH side of the map on ENTRY side, and SOUTH side on EXIT side:
You will need to set the ENTRY side's dir to 2, IE SOUTH, as that's the direction you will moving coming FROM the EXIT side.
IE: Directions should be set based on the direction of travel.
- Each side must have the same orientation, e.g. horizontal on both sides, or vertical on both sides.
- Portals can be made to be longer than 1x1 with <code>/obj/effect/map_effect/portal/line</code>s,
but both sides must have the same length.
- If portal lines are added, they must form a straight line and be next to a portal master or another portal line.
- If portal lines are used, both portal masters should be in the same relative position among the lines.
E.g. both being on the left most side on a horizontal row.</p>
<p>Portals also have some limitations to be aware of when mapping. Some of these are not an issue if you're trying to make an 'obvious' portal;
- The objects seen through portals are purely visual, which has many implications,
such as simple_mob AIs being blind to mobs on the other side of portals.
- Objects on the other side of a portal can be interacted with if the interaction has no range limitation,
or the distance between the two portal sides happens to be less than the interaction max range. Examine will probably work,
while picking up an item that appears to be next to you will fail.
- Sounds currently are not carried across portals.
- Mismatched lighting between each portal end can make the portal look obvious.
- Portals look weird when observing as a ghost, or otherwise when able to see through walls. Meson vision will also spoil the illusion.
- Walls that change icons based on neightboring walls can give away that a portal is nearby if both sides don't have a similar transition.
- Projectiles that pass through portals will generally work as intended, however aiming and firing upon someone on the other side of a portal
will likely be weird due to the click targeting the real position of the thing clicked instead of the apparent position.
Thrown objects suffer a similar fate.
- The tiles that are visually shown across a portal are determined based on visibility at the time of portal initialization,
and currently don't update, meaning that opacity changes are not reflected, e.g. a wall is deconstructed, or an airlock is opened.
- There is currently a small but somewhat noticable pause in mob movement when moving across a portal,
as a result of the mob's glide animation being inturrupted by a teleport.
- Gas is not transferred through portals, and ZAS is oblivious to them.</p>
<p>A lot of those limitations can potentially be solved with some more work. Otherwise, portals work best in static environments like Points of Interest,
when portals are shortly lived, or when portals are made to be obvious with special effects.</p><table class="summary" cellspacing="0"><tr><td colspan="2"><h2>Vars</h2></td></tr><tr><th><a href="obj/effect/map_effect/portal.html#var/portal_distance_x">portal_distance_x</a></th><td>How far the portal is from the left edge, in tiles.</td></tr><tr><th><a href="obj/effect/map_effect/portal.html#var/portal_distance_y">portal_distance_y</a></th><td>How far the portal is from the top edge.</td></tr><tr><th><a href="obj/effect/map_effect/portal.html#var/total_height">total_height</a></th><td></td></tr><tr><td colspan="2"><h2>Procs</h2></td></tr><tr><th><a href="obj/effect/map_effect/portal.html#proc/Crossed">Crossed</a></th><td>Called when something touches the portal, and usually teleports them to the other side.</td></tr><tr><th><a href="obj/effect/map_effect/portal.html#proc/calculate_dimensions">calculate_dimensions</a></th><td>Determines the size of the block of turfs inside <code>vis_contents</code>, and where the portal is in relation to that.</td></tr><tr><th><a href="obj/effect/map_effect/portal.html#proc/get_focused_turf">get_focused_turf</a></th><td></td></tr></table><h2 id="var">Var Details</h2><h3 id="var/portal_distance_x"><aside class="declaration">var </aside>portal_distance_x <aside>– </aside> <a href="https://github.com/Baystation12/Baystation12/blob/184edfd8b360868f05186630736e3d1846726650/code/game/objects/effects/map/portal.dm#L65"><img src="git.png" width="16" height="16" title="code/game/objects/effects/map/portal.dm 65"></a></h3><p>How far the portal is from the left edge, in tiles.</p><h3 id="var/portal_distance_y"><aside class="declaration">var </aside>portal_distance_y <aside>– </aside> <a href="https://github.com/Baystation12/Baystation12/blob/184edfd8b360868f05186630736e3d1846726650/code/game/objects/effects/map/portal.dm#L67"><img src="git.png" width="16" height="16" title="code/game/objects/effects/map/portal.dm 67"></a></h3><p>How far the portal is from the top edge.</p><h3 id="var/total_height"><aside class="declaration">var </aside>total_height <aside>– </aside> <a href="https://github.com/Baystation12/Baystation12/blob/184edfd8b360868f05186630736e3d1846726650/code/game/objects/effects/map/portal.dm#L61"><img src="git.png" width="16" height="16" title="code/game/objects/effects/map/portal.dm 61"></a></h3><ul>
<li>Information used to apply <code>pixel_[x|y]</code> offsets so that the visuals line up.
Set automatically by <code>calculate_dimensions()</code>. Measured in tiles </li>
</ul><h2 id="proc">Proc Details</h2><h3 id="proc/Crossed">Crossed<aside>(/<a href="atom.html">atom</a>/<a href="atom/movable.html">movable</a>/atom)  <a href="https://github.com/Baystation12/Baystation12/blob/184edfd8b360868f05186630736e3d1846726650/code/game/objects/effects/map/portal.dm#L78"><img src="git.png" width="16" height="16" title="code/game/objects/effects/map/portal.dm 78"></a></aside></h3><p>Called when something touches the portal, and usually teleports them to the other side.</p><h3 id="proc/calculate_dimensions"><aside class="declaration">proc </aside>calculate_dimensions<aside>()  <a href="https://github.com/Baystation12/Baystation12/blob/184edfd8b360868f05186630736e3d1846726650/code/game/objects/effects/map/portal.dm#L106"><img src="git.png" width="16" height="16" title="code/game/objects/effects/map/portal.dm 106"></a></aside></h3><p>Determines the size of the block of turfs inside <code>vis_contents</code>, and where the portal is in relation to that.</p><h3 id="proc/get_focused_turf"><aside class="declaration">proc </aside>get_focused_turf<aside>()  <a href="https://github.com/Baystation12/Baystation12/blob/184edfd8b360868f05186630736e3d1846726650/code/game/objects/effects/map/portal.dm#L102"><img src="git.png" width="16" height="16" title="code/game/objects/effects/map/portal.dm 102"></a></aside></h3><ul>
<li>'Focused turf' is the turf directly in front of a portal,
and it is used both as the destination when crossing, as well as the PoV for visuals.</li>
</ul></main><footer>baystation12.dme <a href="https://github.com/Baystation12/Baystation12/tree/184edfd8b360868f05186630736e3d1846726650">184edfd</a> (dev) — <a href="https://github.com/SpaceManiac/SpacemanDMM/blob/master/crates/dmdoc/README.md">dmdoc 1.9.0</a></footer></body></html>